---
apiVersion: v1
kind: Namespace
metadata:
  name: keptn-lifecycle-toolkit-system
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnappcreationrequests.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnAppCreationRequest
    listKind: KeptnAppCreationRequestList
    plural: keptnappcreationrequests
    singular: keptnappcreationrequest
  scope: Namespaced
  versions:
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnAppCreationRequest is the Schema for the keptnappcreationrequests
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppCreationRequestSpec defines the desired state of
                KeptnAppCreationRequest
              properties:
                appName:
                  description: AppName is the name of the KeptnApp the KeptnAppCreationRequest
                    should create if no user-defined object with that name is found.
                  type: string
              required:
                - appName
              type: object
            status:
              description: KeptnAppCreationRequestStatus defines the observed state
                of KeptnAppCreationRequest
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnapps.lifecycle.keptn.sh
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        service:
          name: lifecycle-webhook-service
          namespace: keptn-lifecycle-toolkit-system
          path: /convert
      conversionReviewVersions:
        - v1
  group: lifecycle.keptn.sh
  names:
    kind: KeptnApp
    listKind: KeptnAppList
    plural: keptnapps
    singular: keptnapp
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnApp is the Schema for the keptnapps API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppSpec defines the desired state of KeptnApp
              properties:
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - version
              type: object
            status:
              description: KeptnAppStatus defines the observed state of KeptnApp
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnApp is the Schema for the keptnapps API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppSpec defines the desired state of KeptnApp
              properties:
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                revision:
                  default: 1
                  type: integer
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - version
              type: object
            status:
              description: KeptnAppStatus defines the observed state of KeptnApp
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnApp is the Schema for the keptnapps API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppSpec defines the desired state of KeptnApp
              properties:
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                revision:
                  default: 1
                  type: integer
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - version
              type: object
            status:
              description: KeptnAppStatus defines the observed state of KeptnApp
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnappversions.lifecycle.keptn.sh
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        service:
          name: lifecycle-webhook-service
          namespace: keptn-lifecycle-toolkit-system
          path: /convert
      conversionReviewVersions:
        - v1
  group: lifecycle.keptn.sh
  names:
    kind: KeptnAppVersion
    listKind: KeptnAppVersionList
    plural: keptnappversions
    shortNames:
      - kav
    singular: keptnappversion
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.workloadOverallStatus
          name: WorkloadOverallStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnAppVersion is the Schema for the keptnappversions API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppVersionSpec defines the desired state of KeptnAppVersion
              properties:
                appName:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - appName
                - version
              type: object
            status:
              description: KeptnAppVersionStatus defines the observed state of KeptnAppVersion
              properties:
                currentPhase:
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      evaluationDefinitionName:
                        type: string
                      evaluationName:
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                      taskDefinitionName:
                        type: string
                      taskName:
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      evaluationDefinitionName:
                        type: string
                      evaluationName:
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                      taskDefinitionName:
                        type: string
                      taskName:
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
                workloadOverallStatus:
                  default: Pending
                  type: string
                workloadStatus:
                  items:
                    properties:
                      status:
                        default: Pending
                        type: string
                      workload:
                        properties:
                          name:
                            type: string
                          version:
                            type: string
                        required:
                          - name
                          - version
                        type: object
                    type: object
                  type: array
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.workloadOverallStatus
          name: WorkloadOverallStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnAppVersion is the Schema for the keptnappversions API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppVersionSpec defines the desired state of KeptnAppVersion
              properties:
                appName:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                revision:
                  default: 1
                  type: integer
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - appName
                - version
              type: object
            status:
              description: KeptnAppVersionStatus defines the observed state of KeptnAppVersion
              properties:
                currentPhase:
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
                workloadOverallStatus:
                  default: Pending
                  type: string
                workloadStatus:
                  items:
                    properties:
                      status:
                        default: Pending
                        type: string
                      workload:
                        properties:
                          name:
                            type: string
                          version:
                            type: string
                        required:
                          - name
                          - version
                        type: object
                    type: object
                  type: array
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.workloadOverallStatus
          name: WorkloadOverallStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnAppVersion is the Schema for the keptnappversions API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnAppVersionSpec defines the desired state of KeptnAppVersion
              properties:
                appName:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                revision:
                  default: 1
                  type: integer
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloads:
                  items:
                    properties:
                      name:
                        type: string
                      version:
                        type: string
                    required:
                      - name
                      - version
                    type: object
                  type: array
              required:
                - appName
                - version
              type: object
            status:
              description: KeptnAppVersionStatus defines the observed state of KeptnAppVersion
              properties:
                currentPhase:
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
                workloadOverallStatus:
                  default: Pending
                  type: string
                workloadStatus:
                  items:
                    properties:
                      status:
                        default: Pending
                        type: string
                      workload:
                        properties:
                          name:
                            type: string
                          version:
                            type: string
                        required:
                          - name
                          - version
                        type: object
                    type: object
                  type: array
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnconfigs.options.keptn.sh
spec:
  group: options.keptn.sh
  names:
    kind: KeptnConfig
    listKind: KeptnConfigList
    plural: keptnconfigs
    singular: keptnconfig
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnConfig is the Schema for the keptnconfigs API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnConfigSpec defines the desired state of KeptnConfig
              properties:
                OTelCollectorUrl:
                  description: OTelCollectorUrl can be used to set the Open Telemetry
                    collector that the operator should use
                  type: string
                keptnAppCreationRequestTimeoutSeconds:
                  default: 30
                  description: KeptnAppCreationRequestTimeoutSeconds is used to set
                    the interval in which automatic app discovery searches for workload
                    to put into the same auto-generated KeptnApp
                  type: integer
              type: object
            status:
              description: KeptnConfigStatus defines the observed state of KeptnConfig
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnevaluationdefinitions.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnEvaluationDefinition
    listKind: KeptnEvaluationDefinitionList
    plural: keptnevaluationdefinitions
    shortNames:
      - ked
    singular: keptnevaluationdefinition
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationDefinition is the Schema for the keptnevaluationdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationDefinitionSpec defines the desired state of
                KeptnEvaluationDefinition
              properties:
                objectives:
                  items:
                    properties:
                      evaluationTarget:
                        type: string
                      name:
                        type: string
                      query:
                        type: string
                    required:
                      - evaluationTarget
                      - name
                      - query
                    type: object
                  type: array
                source:
                  type: string
              required:
                - objectives
                - source
              type: object
            status:
              description: KeptnEvaluationDefinitionStatus defines the observed state
                of KeptnEvaluationDefinition
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationDefinition is the Schema for the keptnevaluationdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationDefinitionSpec defines the desired state of
                KeptnEvaluationDefinition
              properties:
                objectives:
                  items:
                    properties:
                      evaluationTarget:
                        type: string
                      name:
                        type: string
                      query:
                        type: string
                    required:
                      - evaluationTarget
                      - name
                      - query
                    type: object
                  type: array
                source:
                  type: string
              required:
                - objectives
                - source
              type: object
            status:
              description: KeptnEvaluationDefinitionStatus defines the observed state
                of KeptnEvaluationDefinition
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationDefinition is the Schema for the keptnevaluationdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationDefinitionSpec defines the desired state of
                KeptnEvaluationDefinition
              properties:
                objectives:
                  items:
                    properties:
                      evaluationTarget:
                        type: string
                      keptnMetricRef:
                        properties:
                          name:
                            type: string
                          namespace:
                            type: string
                        required:
                          - name
                        type: object
                    required:
                      - evaluationTarget
                      - keptnMetricRef
                    type: object
                  type: array
              required:
                - objectives
              type: object
            status:
              description: KeptnEvaluationDefinitionStatus defines the observed state
                of KeptnEvaluationDefinition
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnevaluationproviders.lifecycle.keptn.sh
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        service:
          name: lifecycle-webhook-service
          namespace: keptn-lifecycle-toolkit-system
          path: /convert
      conversionReviewVersions:
        - v1
  group: lifecycle.keptn.sh
  names:
    kind: KeptnEvaluationProvider
    listKind: KeptnEvaluationProviderList
    plural: keptnevaluationproviders
    shortNames:
      - kep
    singular: keptnevaluationprovider
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationProvider is the Schema for the keptnevaluationproviders
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationProviderSpec defines the desired state of
                KeptnEvaluationProvider
              properties:
                secretName:
                  type: string
                targetServer:
                  type: string
              required:
                - targetServer
              type: object
            status:
              description: KeptnEvaluationProviderStatus defines the observed state
                of KeptnEvaluationProvider
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationProvider is the Schema for the keptnevaluationproviders
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationProviderSpec defines the desired state of
                KeptnEvaluationProvider
              properties:
                secretKeyRef:
                  description: SecretKeySelector selects a key of a Secret.
                  properties:
                    key:
                      description: The key of the secret to select from.  Must be a
                        valid secret key.
                      type: string
                    name:
                      description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                      type: string
                    optional:
                      description: Specify whether the Secret or its key must be defined
                      type: boolean
                  required:
                    - key
                  type: object
                  x-kubernetes-map-type: atomic
                targetServer:
                  type: string
              required:
                - targetServer
              type: object
            status:
              description: KeptnEvaluationProviderStatus defines the observed state
                of KeptnEvaluationProvider
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnEvaluationProvider is the Schema for the keptnevaluationproviders
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationProviderSpec defines the desired state of
                KeptnEvaluationProvider
              properties:
                secretKeyRef:
                  description: SecretKeySelector selects a key of a Secret.
                  properties:
                    key:
                      description: The key of the secret to select from.  Must be a
                        valid secret key.
                      type: string
                    name:
                      description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                      type: string
                    optional:
                      description: Specify whether the Secret or its key must be defined
                      type: boolean
                  required:
                    - key
                  type: object
                  x-kubernetes-map-type: atomic
                targetServer:
                  type: string
              required:
                - targetServer
              type: object
            status:
              description: KeptnEvaluationProviderStatus defines the observed state
                of KeptnEvaluationProvider
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnevaluations.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnEvaluation
    listKind: KeptnEvaluationList
    plural: keptnevaluations
    shortNames:
      - ke
    singular: keptnevaluation
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.retryCount
          name: RetryCount
          type: string
        - jsonPath: .status.evaluationStatus
          name: EvaluationStatus
          type: string
        - jsonPath: .status.overallStatus
          name: OverallStatus
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnEvaluation is the Schema for the keptnevaluations API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationSpec defines the desired state of KeptnEvaluation
              properties:
                appName:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                evaluationDefinition:
                  type: string
                failAction:
                  type: string
                retries:
                  default: 10
                  type: integer
                retryInterval:
                  default: 5s
                  pattern: ^0|([0-9]+(\.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - evaluationDefinition
                - workloadVersion
              type: object
            status:
              description: KeptnEvaluationStatus defines the observed state of KeptnEvaluation
              properties:
                endTime:
                  format: date-time
                  type: string
                evaluationStatus:
                  additionalProperties:
                    properties:
                      message:
                        type: string
                      status:
                        type: string
                      value:
                        type: string
                    required:
                      - status
                      - value
                    type: object
                  type: object
                overallStatus:
                  default: Pending
                  type: string
                retryCount:
                  default: 0
                  type: integer
                startTime:
                  format: date-time
                  type: string
              required:
                - evaluationStatus
                - overallStatus
                - retryCount
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.retryCount
          name: RetryCount
          type: string
        - jsonPath: .status.evaluationStatus
          name: EvaluationStatus
          type: string
        - jsonPath: .status.overallStatus
          name: OverallStatus
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnEvaluation is the Schema for the keptnevaluations API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationSpec defines the desired state of KeptnEvaluation
              properties:
                appName:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                evaluationDefinition:
                  type: string
                failAction:
                  type: string
                retries:
                  default: 10
                  type: integer
                retryInterval:
                  default: 5s
                  pattern: ^0|([0-9]+(\.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - evaluationDefinition
                - workloadVersion
              type: object
            status:
              description: KeptnEvaluationStatus defines the observed state of KeptnEvaluation
              properties:
                endTime:
                  format: date-time
                  type: string
                evaluationStatus:
                  additionalProperties:
                    properties:
                      message:
                        type: string
                      status:
                        type: string
                      value:
                        type: string
                    required:
                      - status
                      - value
                    type: object
                  type: object
                overallStatus:
                  default: Pending
                  type: string
                retryCount:
                  default: 0
                  type: integer
                startTime:
                  format: date-time
                  type: string
              required:
                - evaluationStatus
                - overallStatus
                - retryCount
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.appName
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.retryCount
          name: RetryCount
          type: string
        - jsonPath: .status.evaluationStatus
          name: EvaluationStatus
          type: string
        - jsonPath: .status.overallStatus
          name: OverallStatus
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnEvaluation is the Schema for the keptnevaluations API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnEvaluationSpec defines the desired state of KeptnEvaluation
              properties:
                appName:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                evaluationDefinition:
                  type: string
                failAction:
                  type: string
                retries:
                  default: 10
                  type: integer
                retryInterval:
                  default: 5s
                  pattern: ^0|([0-9]+(\.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - evaluationDefinition
                - workloadVersion
              type: object
            status:
              description: KeptnEvaluationStatus defines the observed state of KeptnEvaluation
              properties:
                endTime:
                  format: date-time
                  type: string
                evaluationStatus:
                  additionalProperties:
                    properties:
                      message:
                        type: string
                      status:
                        type: string
                      value:
                        type: string
                    required:
                      - status
                      - value
                    type: object
                  type: object
                overallStatus:
                  default: Pending
                  type: string
                retryCount:
                  default: 0
                  type: integer
                startTime:
                  format: date-time
                  type: string
              required:
                - evaluationStatus
                - overallStatus
                - retryCount
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptntaskdefinitions.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnTaskDefinition
    listKind: KeptnTaskDefinitionList
    plural: keptntaskdefinitions
    singular: keptntaskdefinition
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnTaskDefinition is the Schema for the keptntaskdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskDefinitionSpec defines the desired state of KeptnTaskDefinition
              properties:
                function:
                  properties:
                    configMapRef:
                      properties:
                        name:
                          type: string
                      type: object
                    functionRef:
                      properties:
                        name:
                          type: string
                      type: object
                    httpRef:
                      properties:
                        url:
                          type: string
                      type: object
                    inline:
                      properties:
                        code:
                          type: string
                      type: object
                    parameters:
                      properties:
                        map:
                          additionalProperties:
                            type: string
                          type: object
                      type: object
                    secureParameters:
                      properties:
                        secret:
                          type: string
                      type: object
                  type: object
              type: object
            status:
              description: KeptnTaskDefinitionStatus defines the observed state of KeptnTaskDefinition
              properties:
                function:
                  description: 'INSERT ADDITIONAL STATUS FIELD - define observed state
                  of cluster Important: Run "make" to regenerate code after modifying
                  this file'
                  properties:
                    configMap:
                      description: 'INSERT ADDITIONAL STATUS FIELD - define observed
                      state of cluster Important: Run "make" to regenerate code after
                      modifying this file'
                      type: string
                  type: object
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnTaskDefinition is the Schema for the keptntaskdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskDefinitionSpec defines the desired state of KeptnTaskDefinition
              properties:
                function:
                  properties:
                    configMapRef:
                      properties:
                        name:
                          type: string
                      type: object
                    functionRef:
                      properties:
                        name:
                          type: string
                      type: object
                    httpRef:
                      properties:
                        url:
                          type: string
                      type: object
                    inline:
                      properties:
                        code:
                          type: string
                      type: object
                    parameters:
                      properties:
                        map:
                          additionalProperties:
                            type: string
                          type: object
                      type: object
                    secureParameters:
                      properties:
                        secret:
                          type: string
                      type: object
                  type: object
              type: object
            status:
              description: KeptnTaskDefinitionStatus defines the observed state of KeptnTaskDefinition
              properties:
                function:
                  description: 'INSERT ADDITIONAL STATUS FIELD - define observed state
                  of cluster Important: Run "make" to regenerate code after modifying
                  this file'
                  properties:
                    configMap:
                      description: 'INSERT ADDITIONAL STATUS FIELD - define observed
                      state of cluster Important: Run "make" to regenerate code after
                      modifying this file'
                      type: string
                  type: object
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnTaskDefinition is the Schema for the keptntaskdefinitions
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskDefinitionSpec defines the desired state of KeptnTaskDefinition
              properties:
                function:
                  properties:
                    configMapRef:
                      properties:
                        name:
                          type: string
                      type: object
                    functionRef:
                      properties:
                        name:
                          type: string
                      type: object
                    httpRef:
                      properties:
                        url:
                          type: string
                      type: object
                    inline:
                      properties:
                        code:
                          type: string
                      type: object
                    parameters:
                      properties:
                        map:
                          additionalProperties:
                            type: string
                          type: object
                      type: object
                    secureParameters:
                      properties:
                        secret:
                          type: string
                      type: object
                  type: object
                retries:
                  default: 10
                  format: int32
                  type: integer
                timeout:
                  default: 5m
                  pattern: ^0|([0-9]+(\.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
                  type: string
              type: object
            status:
              description: KeptnTaskDefinitionStatus defines the observed state of KeptnTaskDefinition
              properties:
                function:
                  description: 'INSERT ADDITIONAL STATUS FIELD - define observed state
                  of cluster Important: Run "make" to regenerate code after modifying
                  this file'
                  properties:
                    configMap:
                      description: 'INSERT ADDITIONAL STATUS FIELD - define observed
                      state of cluster Important: Run "make" to regenerate code after
                      modifying this file'
                      type: string
                  type: object
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptntasks.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnTask
    listKind: KeptnTaskList
    plural: keptntasks
    singular: keptntask
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.jobName
          name: Job Name
          type: string
        - jsonPath: .status.status
          name: Status
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnTask is the Schema for the keptntasks API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskSpec defines the desired state of KeptnTask
              properties:
                app:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                context:
                  properties:
                    appName:
                      type: string
                    appVersion:
                      type: string
                    objectType:
                      type: string
                    taskType:
                      type: string
                    workloadName:
                      type: string
                    workloadVersion:
                      type: string
                  required:
                    - appName
                    - appVersion
                    - objectType
                    - taskType
                    - workloadName
                    - workloadVersion
                  type: object
                parameters:
                  properties:
                    map:
                      additionalProperties:
                        type: string
                      type: object
                  type: object
                secureParameters:
                  properties:
                    secret:
                      type: string
                  type: object
                taskDefinition:
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - app
                - appVersion
                - context
                - taskDefinition
                - workload
                - workloadVersion
              type: object
            status:
              description: KeptnTaskStatus defines the observed state of KeptnTask
              properties:
                endTime:
                  format: date-time
                  type: string
                jobName:
                  type: string
                message:
                  type: string
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.jobName
          name: Job Name
          type: string
        - jsonPath: .status.status
          name: Status
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnTask is the Schema for the keptntasks API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskSpec defines the desired state of KeptnTask
              properties:
                app:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                context:
                  properties:
                    appName:
                      type: string
                    appVersion:
                      type: string
                    objectType:
                      type: string
                    taskType:
                      type: string
                    workloadName:
                      type: string
                    workloadVersion:
                      type: string
                  required:
                    - appName
                    - appVersion
                    - objectType
                    - taskType
                    - workloadName
                    - workloadVersion
                  type: object
                parameters:
                  properties:
                    map:
                      additionalProperties:
                        type: string
                      type: object
                  type: object
                secureParameters:
                  properties:
                    secret:
                      type: string
                  type: object
                taskDefinition:
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - app
                - appVersion
                - context
                - taskDefinition
                - workload
                - workloadVersion
              type: object
            status:
              description: KeptnTaskStatus defines the observed state of KeptnTask
              properties:
                endTime:
                  format: date-time
                  type: string
                jobName:
                  type: string
                message:
                  type: string
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.appVersion
          name: AppVersion
          type: string
        - jsonPath: .spec.workload
          name: WorkloadName
          type: string
        - jsonPath: .spec.workloadVersion
          name: WorkloadVersion
          type: string
        - jsonPath: .status.jobName
          name: Job Name
          type: string
        - jsonPath: .status.status
          name: Status
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnTask is the Schema for the keptntasks API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnTaskSpec defines the desired state of KeptnTask
              properties:
                app:
                  type: string
                appVersion:
                  type: string
                checkType:
                  type: string
                context:
                  properties:
                    appName:
                      type: string
                    appVersion:
                      type: string
                    objectType:
                      type: string
                    taskType:
                      type: string
                    workloadName:
                      type: string
                    workloadVersion:
                      type: string
                  required:
                    - appName
                    - appVersion
                    - objectType
                    - taskType
                    - workloadName
                    - workloadVersion
                  type: object
                parameters:
                  properties:
                    map:
                      additionalProperties:
                        type: string
                      type: object
                  type: object
                retries:
                  default: 10
                  format: int32
                  type: integer
                secureParameters:
                  properties:
                    secret:
                      type: string
                  type: object
                taskDefinition:
                  type: string
                timeout:
                  default: 5m
                  pattern: ^0|([0-9]+(\.[0-9]+)?(ns|us|µs|ms|s|m|h))+$
                  type: string
                workload:
                  type: string
                workloadVersion:
                  type: string
              required:
                - app
                - appVersion
                - context
                - taskDefinition
                - workload
                - workloadVersion
              type: object
            status:
              description: KeptnTaskStatus defines the observed state of KeptnTask
              properties:
                endTime:
                  format: date-time
                  type: string
                jobName:
                  type: string
                message:
                  type: string
                reason:
                  type: string
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnworkloadinstances.lifecycle.keptn.sh
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        service:
          name: lifecycle-webhook-service
          namespace: keptn-lifecycle-toolkit-system
          path: /convert
      conversionReviewVersions:
        - v1
  group: lifecycle.keptn.sh
  names:
    kind: KeptnWorkloadInstance
    listKind: KeptnWorkloadInstanceList
    plural: keptnworkloadinstances
    shortNames:
      - kwi
    singular: keptnworkloadinstance
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.workloadName
          name: WorkloadName
          type: string
        - jsonPath: .spec.version
          name: WorkloadVersion
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.deploymentStatus
          name: DeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnWorkloadInstance is the Schema for the keptnworkloadinstances
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadInstanceSpec defines the desired state of KeptnWorkloadInstance
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloadName:
                  type: string
              required:
                - app
                - resourceReference
                - version
                - workloadName
              type: object
            status:
              description: KeptnWorkloadInstanceStatus defines the observed state of
                KeptnWorkloadInstance
              properties:
                currentPhase:
                  type: string
                deploymentStatus:
                  default: Pending
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      evaluationDefinitionName:
                        type: string
                      evaluationName:
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                      taskDefinitionName:
                        type: string
                      taskName:
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      evaluationDefinitionName:
                        type: string
                      evaluationName:
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      endTime:
                        format: date-time
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                      taskDefinitionName:
                        type: string
                      taskName:
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.workloadName
          name: WorkloadName
          type: string
        - jsonPath: .spec.version
          name: WorkloadVersion
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.deploymentStatus
          name: DeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnWorkloadInstance is the Schema for the keptnworkloadinstances
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadInstanceSpec defines the desired state of KeptnWorkloadInstance
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloadName:
                  type: string
              required:
                - app
                - resourceReference
                - version
                - workloadName
              type: object
            status:
              description: KeptnWorkloadInstanceStatus defines the observed state of
                KeptnWorkloadInstance
              properties:
                currentPhase:
                  type: string
                deploymentStatus:
                  default: Pending
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.workloadName
          name: WorkloadName
          type: string
        - jsonPath: .spec.version
          name: WorkloadVersion
          type: string
        - jsonPath: .status.currentPhase
          name: Phase
          type: string
        - jsonPath: .status.preDeploymentStatus
          name: PreDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.preDeploymentEvaluationStatus
          name: PreDeploymentEvaluationStatus
          priority: 1
          type: string
        - jsonPath: .status.deploymentStatus
          name: DeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentStatus
          name: PostDeploymentStatus
          priority: 1
          type: string
        - jsonPath: .status.postDeploymentEvaluationStatus
          name: PostDeploymentEvaluationStatus
          priority: 1
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnWorkloadInstance is the Schema for the keptnworkloadinstances
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadInstanceSpec defines the desired state of KeptnWorkloadInstance
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                previousVersion:
                  type: string
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                traceId:
                  additionalProperties:
                    type: string
                  type: object
                version:
                  type: string
                workloadName:
                  type: string
              required:
                - app
                - resourceReference
                - version
                - workloadName
              type: object
            status:
              description: KeptnWorkloadInstanceStatus defines the observed state of
                KeptnWorkloadInstance
              properties:
                currentPhase:
                  type: string
                deploymentStatus:
                  default: Pending
                  type: string
                endTime:
                  format: date-time
                  type: string
                phaseTraceIDs:
                  additionalProperties:
                    additionalProperties:
                      type: string
                    description: MapCarrier is a TextMapCarrier that uses a map held
                      in memory as a storage medium for propagated key-value pairs.
                    type: object
                  type: object
                postDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                postDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                postDeploymentStatus:
                  default: Pending
                  type: string
                postDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentEvaluationStatus:
                  default: Pending
                  type: string
                preDeploymentEvaluationTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                preDeploymentStatus:
                  default: Pending
                  type: string
                preDeploymentTaskStatus:
                  items:
                    properties:
                      definitionName:
                        description: DefinitionName is the name of the EvaluationDefinition/TaskDefiniton
                        type: string
                      endTime:
                        format: date-time
                        type: string
                      name:
                        description: Name is the name of the Evaluation/Task
                        type: string
                      startTime:
                        format: date-time
                        type: string
                      status:
                        default: Pending
                        type: string
                    type: object
                  type: array
                startTime:
                  format: date-time
                  type: string
                status:
                  default: Pending
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: lifecycle.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnworkloads.lifecycle.keptn.sh
spec:
  group: lifecycle.keptn.sh
  names:
    kind: KeptnWorkload
    listKind: KeptnWorkloadList
    plural: keptnworkloads
    singular: keptnworkload
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnWorkload is the Schema for the keptnworkloads API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadSpec defines the desired state of KeptnWorkload
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                version:
                  type: string
              required:
                - app
                - resourceReference
                - version
              type: object
            status:
              description: KeptnWorkloadStatus defines the observed state of KeptnWorkload
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnWorkload is the Schema for the keptnworkloads API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadSpec defines the desired state of KeptnWorkload
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                version:
                  type: string
              required:
                - app
                - resourceReference
                - version
              type: object
            status:
              description: KeptnWorkloadStatus defines the observed state of KeptnWorkload
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.app
          name: AppName
          type: string
        - jsonPath: .spec.version
          name: Version
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnWorkload is the Schema for the keptnworkloads API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnWorkloadSpec defines the desired state of KeptnWorkload
              properties:
                app:
                  type: string
                postDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                postDeploymentTasks:
                  items:
                    type: string
                  type: array
                preDeploymentEvaluations:
                  items:
                    type: string
                  type: array
                preDeploymentTasks:
                  items:
                    type: string
                  type: array
                resourceReference:
                  properties:
                    kind:
                      type: string
                    name:
                      type: string
                    uid:
                      description: UID is a type that holds unique ID values, including
                        UUIDs.  Because we don't ONLY use UUIDs, this is an alias to
                        string.  Being a type captures intent and helps make sure that
                        UIDs and names do not get conflated.
                      type: string
                  required:
                    - kind
                    - name
                    - uid
                  type: object
                version:
                  type: string
              required:
                - app
                - resourceReference
                - version
              type: object
            status:
              description: KeptnWorkloadStatus defines the observed state of KeptnWorkload
              properties:
                currentVersion:
                  type: string
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: lifecycle-operator
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: lifecycle-operator-leader-election-role
  namespace: keptn-lifecycle-toolkit-system
rules:
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - coordination.k8s.io
    resources:
      - leases
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: lifecycle-operator-role
rules:
  - apiGroups:
      - apps
    resources:
      - daemonsets
      - deployments
      - replicasets
      - statefulsets
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - argoproj.io
    resources:
      - rollouts
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - batch
    resources:
      - jobs
    verbs:
      - create
      - get
      - list
      - update
      - watch
  - apiGroups:
      - batch
    resources:
      - jobs/status
    verbs:
      - get
      - list
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - create
      - get
      - list
      - update
      - watch
  - apiGroups:
      - ""
    resources:
      - deployments
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
      - watch
  - apiGroups:
      - ""
    resources:
      - namespaces
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - pods
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - get
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappcreationrequests
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappcreationrequests/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappcreationrequests/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnapps
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnapps/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnapps/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversion
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversion/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversion/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversions
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversions/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnappversions/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnevaluationdefinitions
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnevaluationproviders
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnevaluations
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnevaluations/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnevaluations/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntaskdefinitions
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntaskdefinitions/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntaskdefinitions/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntasks
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntasks/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptntasks/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloadinstances
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloadinstances/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloadinstances/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloads
    verbs:
      - create
      - delete
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloads/finalizers
    verbs:
      - update
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloads/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - keptnmetrics
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - options.keptn.sh
    resources:
      - keptnconfigs
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - options.keptn.sh
    resources:
      - keptnconfigs/status
    verbs:
      - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: lifecycle-operator-leader-election-rolebinding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: lifecycle-operator-leader-election-role
subjects:
  - kind: ServiceAccount
    name: lifecycle-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: lifecycle-operator-rolebinding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: lifecycle-operator-role
subjects:
  - kind: ServiceAccount
    name: lifecycle-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: lifecycle-operator-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: lifecycle-operator-role
subjects:
  - kind: ServiceAccount
    name: lifecycle-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: v1
data:
  controller_manager_config.yaml: |
    apiVersion: controller-runtime.sigs.k8s.io/v1alpha1
    kind: ControllerManagerConfig
    health:
      healthProbeBindAddress: :8081
    metrics:
      bindAddress: 127.0.0.1:8080
    webhook:
      port: 9443
    leaderElection:
      leaderElect: true
      resourceName: 6b866dd9.keptn.sh

    # leaderElectionReleaseOnCancel defines if the leader should step down volume
    # when the Manager ends. This requires the binary to immediately end when the
    # Manager is stopped, otherwise, this setting is unsafe. Setting this significantly
    # speeds up voluntary leader transitions as the new leader don't have to wait
    # LeaseDuration time first.
    # In the default scaffold provided, the program ends immediately after
    # the manager stops, so would be fine to enable this option. However,
    # if you are doing or is intended to do any operation such as perform cleanups
    # after the manager stops then its usage might be unsafe.
    # leaderElectionReleaseOnCancel: true
kind: ConfigMap
metadata:
  name: lifecycle-manager-config
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: v1
kind: Service
metadata:
  labels:
    control-plane: lifecycle-operator
  name: lifecycle-operator-metrics-service
  namespace: keptn-lifecycle-toolkit-system
spec:
  ports:
    - name: metrics
      port: 2222
      protocol: TCP
      targetPort: metrics
  selector:
    control-plane: lifecycle-operator
---
apiVersion: v1
kind: Service
metadata:
  name: lifecycle-webhook-service
  namespace: keptn-lifecycle-toolkit-system
spec:
  ports:
    - port: 443
      protocol: TCP
      targetPort: 9443
  selector:
    control-plane: lifecycle-operator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    control-plane: lifecycle-operator
    keptn.sh/inject-cert: "true"
  name: lifecycle-operator
  namespace: keptn-lifecycle-toolkit-system
spec:
  replicas: 1
  selector:
    matchLabels:
      control-plane: lifecycle-operator
  template:
    metadata:
      annotations:
        kubectl.kubernetes.io/default-container: manager
        metrics.dynatrace.com/port: "2222"
        metrics.dynatrace.com/scrape: "true"
      labels:
        control-plane: lifecycle-operator
    spec:
      containers:
        - args:
            - webhook-server
            - --certs-dir=/tmp/k8s-webhook-server/serving-certs/
            - --leader-elect
            - --adapter-port=6443
            - --adapter-certs-dir=/tmp/metrics-adapter/serving-certs
            - --v=10
          command:
            - /manager
          env:
            - name: POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: FUNCTION_RUNNER_IMAGE
              value: ghcr.keptn.sh/keptn/functions-runtime:v0.7.1
            - name: OTEL_COLLECTOR_URL
              value: otel-collector:4317
            - name: KEPTN_APP_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_APP_CREATION_REQUEST_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_APP_VERSION_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_EVALUATION_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_TASK_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_TASK_DEFINITION_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_WORKLOAD_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: KEPTN_WORKLOAD_INSTANCE_CONTROLLER_LOG_LEVEL
              value: "0"
            - name: OPTIONS_CONTROLLER_LOG_LEVEL
              value: "0"
          image: ghcr.keptn.sh/keptn/lifecycle-operator:v0.7.1
          imagePullPolicy: Always
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8081
            initialDelaySeconds: 15
            periodSeconds: 20
          name: manager
          ports:
            - containerPort: 9443
              name: webhook-server
              protocol: TCP
            - containerPort: 2222
              name: metrics
              protocol: TCP
          readinessProbe:
            httpGet:
              path: /readyz
              port: 8081
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            limits:
              cpu: 500m
              memory: 128Mi
            requests:
              cpu: 5m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
                - ALL
            privileged: false
            runAsGroup: 65532
            runAsNonRoot: true
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - mountPath: /tmp/k8s-webhook-server/serving-certs/
              name: certs-dir
            - mountPath: /tmp/metrics-adapter/serving-certs
              name: adapter-certs-dir
      securityContext:
        runAsNonRoot: true
      serviceAccountName: lifecycle-operator
      terminationGracePeriodSeconds: 10
      volumes:
        - emptyDir: {}
          name: certs-dir
        - emptyDir: {}
          name: adapter-certs-dir
---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  creationTimestamp: null
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    keptn.sh/inject-cert: "true"
  name: lifecycle-mutating-webhook-configuration
webhooks:
  - admissionReviewVersions:
      - v1
    clientConfig:
      service:
        name: lifecycle-webhook-service
        namespace: keptn-lifecycle-toolkit-system
        path: /mutate-v1-pod
    failurePolicy: Fail
    name: mpod.keptn.sh
    namespaceSelector:
      matchExpressions:
        - key: control-plane
          operator: NotIn
          values:
            - lifecycle-operator
        - key: kubernetes.io/metadata.name
          operator: NotIn
          values:
            - kube-system
            - kube-public
            - kube-node-lease
            - cert-manager
            - keptn-lifecycle-toolkit-system
            - observability
            - monitoring
    rules:
      - apiGroups:
          - ""
        apiVersions:
          - v1
        operations:
          - CREATE
          - UPDATE
        resources:
          - pods
    sideEffects: None
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: keptn-scheduler
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: keptn-scheduler
rules:
  - apiGroups:
      - ""
    resources:
      - namespaces
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
      - events.k8s.io
    resources:
      - events
    verbs:
      - create
      - patch
      - update
  - apiGroups:
      - coordination.k8s.io
    resources:
      - leases
    verbs:
      - create
  - apiGroups:
      - coordination.k8s.io
    resourceNames:
      - kube-scheduler
    resources:
      - leases
    verbs:
      - get
      - update
  - apiGroups:
      - ""
    resources:
      - endpoints
    verbs:
      - create
  - apiGroups:
      - ""
    resourceNames:
      - kube-scheduler
    resources:
      - endpoints
    verbs:
      - get
      - update
  - apiGroups:
      - ""
    resources:
      - nodes
    verbs:
      - get
      - list
      - watch
      - patch
  - apiGroups:
      - ""
    resources:
      - pods
    verbs:
      - delete
      - get
      - list
      - watch
      - update
  - apiGroups:
      - ""
    resources:
      - bindings
      - pods/binding
    verbs:
      - create
  - apiGroups:
      - ""
    resources:
      - pods/status
    verbs:
      - patch
      - update
  - apiGroups:
      - ""
    resources:
      - replicationcontrollers
      - services
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - apps
      - extensions
    resources:
      - replicasets
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - apps
    resources:
      - statefulsets
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - policy
    resources:
      - poddisruptionbudgets
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - persistentvolumeclaims
      - persistentvolumes
    verbs:
      - get
      - list
      - watch
      - patch
      - update
  - apiGroups:
      - authentication.k8s.io
    resources:
      - tokenreviews
    verbs:
      - create
  - apiGroups:
      - authorization.k8s.io
    resources:
      - subjectaccessreviews
    verbs:
      - create
  - apiGroups:
      - storage.k8s.io
    resources:
      - csinodes
      - storageclasses
      - csidrivers
      - csistoragecapacities
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - scheduling.sigs.k8s.io
    resources:
      - podgroups
      - elasticquotas
    verbs:
      - get
      - list
      - watch
      - create
      - delete
      - update
      - patch
  - apiGroups:
      - lifecycle.keptn.sh
    resources:
      - keptnworkloadinstances
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: extension-apiserver-authentication-reader
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: extension-apiserver-authentication-reader
subjects:
  - kind: ServiceAccount
    name: keptn-scheduler
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: keptn-scheduler
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: keptn-scheduler
subjects:
  - kind: ServiceAccount
    name: keptn-scheduler
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: v1
data:
  scheduler-config.yaml: |
    apiVersion: kubescheduler.config.k8s.io/v1beta3
    kind: KubeSchedulerConfiguration
    leaderElection:
      leaderElect: false
    profiles:
      # Compose all plugins in one profile
      - schedulerName: keptn-scheduler
        plugins:
          permit:
            enabled:
              - name: "KLCPermit"
kind: ConfigMap
metadata:
  name: scheduler-config
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    component: scheduler
  name: scheduler
  namespace: keptn-lifecycle-toolkit-system
spec:
  replicas: 1
  selector:
    matchLabels:
      component: scheduler
  template:
    metadata:
      labels:
        component: scheduler
    spec:
      containers:
        - command:
            - /bin/kube-scheduler
            - --config=/etc/kubernetes/scheduler-config.yaml
          env:
            - name: OTEL_COLLECTOR_URL
              value: otel-collector:4317
          image: ghcr.keptn.sh/keptn/scheduler:v0.7.1
          imagePullPolicy: Always
          livenessProbe:
            httpGet:
              path: /healthz
              port: 10259
              scheme: HTTPS
            initialDelaySeconds: 15
          name: scheduler
          readinessProbe:
            httpGet:
              path: /healthz
              port: 10259
              scheme: HTTPS
          resources:
            limits:
              cpu: 300m
              memory: 100Mi
            requests:
              cpu: 10m
              memory: 20Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
                - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsNonRoot: true
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - mountPath: /etc/kubernetes
              name: scheduler-config
              readOnly: true
      hostNetwork: false
      hostPID: false
      serviceAccountName: keptn-scheduler
      volumes:
        - configMap:
            name: scheduler-config
          name: scheduler-config
---
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kuberentes.io/instance: certificate-operator
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: serviceaccount
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
  name: certificate-operator
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: certificate-operator-role
  namespace: keptn-lifecycle-toolkit-system
rules:
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - create
      - list
      - watch
  - apiGroups:
      - ""
    resourceNames:
      - klt-certs
    resources:
      - secrets
    verbs:
      - get
      - patch
      - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/instance: leader-election-role
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: role
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
  name: leader-election-role
  namespace: keptn-lifecycle-toolkit-system
rules:
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - coordination.k8s.io
    resources:
      - leases
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: certificate-operator-role
rules:
  - apiGroups:
      - admissionregistration.k8s.io
    resources:
      - mutatingwebhookconfigurations
    verbs:
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - admissionregistration.k8s.io
    resources:
      - validatingwebhookconfigurations
    verbs:
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - apiextensions.k8s.io
    resources:
      - customresourcedefinitions
    verbs:
      - get
      - list
      - patch
      - update
      - watch
  - apiGroups:
      - apps
    resources:
      - deployments
    verbs:
      - get
      - list
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/instance: certificate-operator-leader-election-rolebinding
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: rolebinding
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
  name: certificate-operator-leader-election-rolebinding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: leader-election-role
subjects:
  - kind: ServiceAccount
    name: certificate-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/instance: certificate-operator-rolebinding
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: rolebinding
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
  name: certificate-operator-role-binding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: certificate-operator-role
subjects:
  - kind: ServiceAccount
    name: certificate-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/instance: certificate-operator-rolebinding
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: clusterrolebinding
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
  name: certificate-operator-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: certificate-operator-role
subjects:
  - kind: ServiceAccount
    name: certificate-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/component: manager
    app.kubernetes.io/created-by: certificate-operator
    app.kubernetes.io/instance: certificate-operator
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: deployment
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    control-plane: certificate-operator
  name: certificate-operator
  namespace: keptn-lifecycle-toolkit-system
spec:
  replicas: 1
  selector:
    matchLabels:
      control-plane: certificate-operator
  template:
    metadata:
      annotations:
        kubectl.kubernetes.io/default-container: manager
      labels:
        control-plane: certificate-operator
    spec:
      containers:
        - args:
            - --leader-elect
          command:
            - /manager
          env:
            - name: NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: LABEL_SELECTOR_KEY
              value: keptn.sh/inject-cert
            - name: LABEL_SELECTOR_VALUE
              value: "true"
          image: ghcr.keptn.sh/keptn/certificate-operator:v0.7.1
          imagePullPolicy: Always
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8081
            initialDelaySeconds: 15
            periodSeconds: 20
          name: manager
          readinessProbe:
            httpGet:
              path: /readyz
              port: 8081
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            limits:
              cpu: 25m
              memory: 64Mi
            requests:
              cpu: 5m
              memory: 16Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
                - ALL
            readOnlyRootFilesystem: true
            runAsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
      securityContext:
        runAsNonRoot: true
      serviceAccountName: certificate-operator
      terminationGracePeriodSeconds: 10
---
apiVersion: v1
kind: Namespace
metadata:
  labels:
    control-plane: metrics-operator
  name: keptn-lifecycle-toolkit-system
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: metrics.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnmetrics.metrics.keptn.sh
spec:
  conversion:
    strategy: Webhook
    webhook:
      clientConfig:
        service:
          name: metrics-webhook-service
          namespace: keptn-lifecycle-toolkit-system
          path: /convert
      conversionReviewVersions:
        - v1
  group: metrics.keptn.sh
  names:
    kind: KeptnMetric
    listKind: KeptnMetricList
    plural: keptnmetrics
    singular: keptnmetric
  scope: Namespaced
  versions:
    - additionalPrinterColumns:
        - jsonPath: .spec.provider.name
          name: Provider
          type: string
        - jsonPath: .spec.query
          name: Query
          type: string
        - jsonPath: .status.value
          name: Value
          type: string
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: KeptnMetric is the Schema for the keptnmetrics API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnMetricSpec defines the desired state of KeptnMetric
              properties:
                fetchIntervalSeconds:
                  description: FetchIntervalSeconds represents the update frequency
                    in seconds that is used to update the metric
                  type: integer
                provider:
                  description: Provider represents the provider object
                  properties:
                    name:
                      description: Name of the provider
                      type: string
                  required:
                    - name
                  type: object
                query:
                  description: Query represents the query to be run
                  type: string
              required:
                - fetchIntervalSeconds
                - provider
                - query
              type: object
            status:
              description: KeptnMetricStatus defines the observed state of KeptnMetric
              properties:
                lastUpdated:
                  description: LastUpdated represents the time when the status data
                    was last updated
                  format: date-time
                  type: string
                rawValue:
                  description: RawValue represents the resulting value in raw format
                  format: byte
                  type: string
                value:
                  description: Value represents the resulting value
                  type: string
              required:
                - lastUpdated
                - rawValue
                - value
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.provider.name
          name: Provider
          type: string
        - jsonPath: .spec.query
          name: Query
          type: string
        - jsonPath: .status.value
          name: Value
          type: string
      name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnMetric is the Schema for the keptnmetrics API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnMetricSpec defines the desired state of KeptnMetric
              properties:
                fetchIntervalSeconds:
                  description: FetchIntervalSeconds represents the update frequency
                    in seconds that is used to update the metric
                  type: integer
                provider:
                  description: Provider represents the provider object
                  properties:
                    name:
                      description: Name of the provider
                      type: string
                  required:
                    - name
                  type: object
                query:
                  description: Query represents the query to be run
                  type: string
              required:
                - fetchIntervalSeconds
                - provider
                - query
              type: object
            status:
              description: KeptnMetricStatus defines the observed state of KeptnMetric
              properties:
                lastUpdated:
                  description: LastUpdated represents the time when the status data
                    was last updated
                  format: date-time
                  type: string
                rawValue:
                  description: RawValue represents the resulting value in raw format
                  format: byte
                  type: string
                value:
                  description: Value represents the resulting value
                  type: string
              required:
                - lastUpdated
                - rawValue
                - value
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - additionalPrinterColumns:
        - jsonPath: .spec.provider.name
          name: Provider
          type: string
        - jsonPath: .spec.query
          name: Query
          type: string
        - jsonPath: .status.value
          name: Value
          type: string
      name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnMetric is the Schema for the keptnmetrics API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnMetricSpec defines the desired state of KeptnMetric
              properties:
                fetchIntervalSeconds:
                  description: FetchIntervalSeconds represents the update frequency
                    in seconds that is used to update the metric
                  type: integer
                provider:
                  description: Provider represents the provider object
                  properties:
                    name:
                      description: Name of the provider
                      type: string
                  required:
                    - name
                  type: object
                query:
                  description: Query represents the query to be run
                  type: string
              required:
                - fetchIntervalSeconds
                - provider
                - query
              type: object
            status:
              description: KeptnMetricStatus defines the observed state of KeptnMetric
              properties:
                lastUpdated:
                  description: LastUpdated represents the time when the status data
                    was last updated
                  format: date-time
                  type: string
                rawValue:
                  description: RawValue represents the resulting value in raw format
                  format: byte
                  type: string
                value:
                  description: Value represents the resulting value
                  type: string
              required:
                - lastUpdated
                - rawValue
                - value
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.4
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    crdGroup: metrics.keptn.sh
    keptn.sh/inject-cert: "true"
  name: keptnmetricsproviders.metrics.keptn.sh
spec:
  group: metrics.keptn.sh
  names:
    kind: KeptnMetricsProvider
    listKind: KeptnMetricsProviderList
    plural: keptnmetricsproviders
    shortNames:
      - kmp
    singular: keptnmetricsprovider
  scope: Namespaced
  versions:
    - name: v1alpha2
      schema:
        openAPIV3Schema:
          description: KeptnMetricsProvider is the Schema for the keptnmetricsproviders
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnMetricsProviderSpec defines the desired state of KeptnMetricsProvider
              properties:
                secretKeyRef:
                  description: SecretKeySelector selects a key of a Secret.
                  properties:
                    key:
                      description: The key of the secret to select from.  Must be a
                        valid secret key.
                      type: string
                    name:
                      description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                      type: string
                    optional:
                      description: Specify whether the Secret or its key must be defined
                      type: boolean
                  required:
                    - key
                  type: object
                  x-kubernetes-map-type: atomic
                targetServer:
                  type: string
              required:
                - targetServer
              type: object
            status:
              description: KeptnMetricsProviderStatus defines the observed state of
                KeptnMetricsProvider
              type: object
          type: object
      served: true
      storage: false
      subresources:
        status: {}
    - name: v1alpha3
      schema:
        openAPIV3Schema:
          description: KeptnMetricsProvider is the Schema for the keptnmetricsproviders
            API
          properties:
            apiVersion:
              description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
              type: string
            kind:
              description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
              type: string
            metadata:
              type: object
            spec:
              description: KeptnMetricsProviderSpec defines the desired state of KeptnMetricsProvider
              properties:
                secretKeyRef:
                  description: SecretKeyRef defines an optional secret for access credentials
                    to the metrics provider.
                  properties:
                    key:
                      description: The key of the secret to select from.  Must be a
                        valid secret key.
                      type: string
                    name:
                      description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                      TODO: Add other useful fields. apiVersion, kind, uid?'
                      type: string
                    optional:
                      description: Specify whether the Secret or its key must be defined
                      type: boolean
                  required:
                    - key
                  type: object
                  x-kubernetes-map-type: atomic
                targetServer:
                  description: TargetServer defined the URL at which the metrics provider
                    is reachable with included port and protocol.
                  type: string
                type:
                  description: Type represents the provider type. This can be one of
                    prometheus, dynatrace, datadog, dql.
                  pattern: prometheus|dynatrace|datadog|dql
                  type: string
              required:
                - targetServer
              type: object
            status:
              description: KeptnMetricsProviderStatus defines the observed state of
                KeptnMetricsProvider
              type: object
          type: object
      served: true
      storage: true
      subresources:
        status: {}
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: metrics-operator
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: metrics-operator-leader-election-role
  namespace: keptn-lifecycle-toolkit-system
rules:
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - coordination.k8s.io
    resources:
      - leases
    verbs:
      - get
      - list
      - watch
      - create
      - update
      - patch
      - delete
  - apiGroups:
      - ""
    resources:
      - events
    verbs:
      - create
      - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: metrics-operator-role
rules:
  - apiGroups:
      - ""
    resources:
      - configmaps
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - ""
    resources:
      - secrets
    verbs:
      - get
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - keptnmetrics
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - keptnmetrics/finalizers
    verbs:
      - update
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - keptnmetrics/status
    verbs:
      - get
      - patch
      - update
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - keptnmetricsproviders
    verbs:
      - get
      - list
      - watch
  - apiGroups:
      - metrics.keptn.sh
    resources:
      - providers
    verbs:
      - get
      - list
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: metrics-operator-server-resources
rules:
  - apiGroups:
      - custom.metrics.k8s.io
    resources:
      - '*'
    verbs:
      - get
      - list
      - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: metrics-operator-leader-election-rolebinding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: metrics-operator-leader-election-role
subjects:
  - kind: ServiceAccount
    name: metrics-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: metrics-operator-rolebinding
  namespace: keptn-lifecycle-toolkit-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: metrics-operator-role
subjects:
  - kind: ServiceAccount
    name: metrics-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: metrics-operator-hpa-controller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: metrics-operator-server-resources
subjects:
  - kind: ServiceAccount
    name: horizontal-pod-autoscaler
    namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: metrics-operator-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: metrics-operator-role
subjects:
  - kind: ServiceAccount
    name: metrics-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: system-auth-delegator
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:auth-delegator
subjects:
  - kind: ServiceAccount
    name: metrics-operator
    namespace: keptn-lifecycle-toolkit-system
---
apiVersion: v1
data:
  controller_manager_config.yaml: |
    apiVersion: controller-runtime.sigs.k8s.io/v1alpha1
    kind: ControllerManagerConfig
    health:
      healthProbeBindAddress: :8081
    metrics:
      bindAddress: 127.0.0.1:8080
    webhook:
      port: 9443
    leaderElection:
      leaderElect: true
      resourceName: 3f8532ca.keptn.sh
    # leaderElectionReleaseOnCancel defines if the leader should step down volume
    # when the Manager ends. This requires the binary to immediately end when the
    # Manager is stopped, otherwise, this setting is unsafe. Setting this significantly
    # speeds up voluntary leader transitions as the new leader don't have to wait
    # LeaseDuration time first.
    # In the default scaffold provided, the program ends immediately after
    # the manager stops, so would be fine to enable this option. However,
    # if you are doing or is intended to do any operation such as perform cleanups
    # after the manager stops then its usage might be unsafe.
    # leaderElectionReleaseOnCancel: true
kind: ConfigMap
metadata:
  name: metrics-manager-config
  namespace: keptn-lifecycle-toolkit-system
---
apiVersion: v1
kind: Service
metadata:
  labels:
    control-plane: metrics-operator
  name: metrics-operator-service
  namespace: keptn-lifecycle-toolkit-system
spec:
  ports:
    - name: https
      port: 8443
      protocol: TCP
      targetPort: https
    - name: custom-metrics
      port: 443
      targetPort: custom-metrics
    - name: metrics
      port: 9999
      protocol: TCP
      targetPort: metrics
  selector:
    control-plane: metrics-operator
---
apiVersion: v1
kind: Service
metadata:
  name: metrics-webhook-service
  namespace: keptn-lifecycle-toolkit-system
spec:
  ports:
    - port: 443
      protocol: TCP
      targetPort: 9443
  selector:
    control-plane: metrics-operator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/part-of: keptn-lifecycle-toolkit
    control-plane: metrics-operator
    keptn.sh/inject-cert: "true"
  name: metrics-operator
  namespace: keptn-lifecycle-toolkit-system
spec:
  replicas: 1
  selector:
    matchLabels:
      control-plane: metrics-operator
  template:
    metadata:
      annotations:
        kubectl.kubernetes.io/default-container: manager
      labels:
        control-plane: metrics-operator
    spec:
      containers:
        - args:
            - webhook-server
            - --certs-dir=/tmp/k8s-webhook-server/serving-certs/
            - --leader-elect
            - --adapter-port=6443
            - --adapter-certs-dir=/tmp/metrics-adapter/serving-certs
            - --v=10
          command:
            - /manager
          env:
            - name: POD_NAMESPACE
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            - name: POD_NAME
              valueFrom:
                fieldRef:
                  fieldPath: metadata.name
            - name: EXPOSE_KEPTN_METRICS
              value: "true"
            - name: METRICS_CONTROLLER_LOG_LEVEL
              value: "0"
          image: ghcr.keptn.sh/keptn/metrics-operator:v0.7.1
          livenessProbe:
            httpGet:
              path: /healthz
              port: 8081
            initialDelaySeconds: 15
            periodSeconds: 20
          name: manager
          ports:
            - containerPort: 9443
              name: webhook-server
              protocol: TCP
            - containerPort: 9999
              name: metrics
              protocol: TCP
            - containerPort: 6443
              name: custom-metrics
              protocol: TCP
          readinessProbe:
            httpGet:
              path: /readyz
              port: 8081
            initialDelaySeconds: 5
            periodSeconds: 10
          resources:
            limits:
              cpu: 500m
              memory: 128Mi
            requests:
              cpu: 10m
              memory: 64Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
                - ALL
            privileged: false
            runAsGroup: 65532
            runAsNonRoot: true
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          volumeMounts:
            - mountPath: /tmp/k8s-webhook-server/serving-certs/
              name: certs-dir
            - mountPath: /tmp/metrics-adapter/serving-certs
              name: adapter-certs-dir
      securityContext:
        runAsNonRoot: true
      serviceAccountName: metrics-operator
      terminationGracePeriodSeconds: 10
      volumes:
        - emptyDir: {}
          name: certs-dir
        - emptyDir: {}
          name: adapter-certs-dir
---
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  name: v1beta1.custom.metrics.k8s.io
spec:
  group: custom.metrics.k8s.io
  groupPriorityMinimum: 100
  insecureSkipTLSVerify: true
  service:
    name: metrics-operator-service
    namespace: keptn-lifecycle-toolkit-system
  version: v1beta1
  versionPriority: 100
---
apiVersion: apiregistration.k8s.io/v1
kind: APIService
metadata:
  name: v1beta2.custom.metrics.k8s.io
spec:
  group: custom.metrics.k8s.io
  groupPriorityMinimum: 100
  insecureSkipTLSVerify: true
  service:
    name: metrics-operator-service
    namespace: keptn-lifecycle-toolkit-system
  version: v1beta2
  versionPriority: 200
